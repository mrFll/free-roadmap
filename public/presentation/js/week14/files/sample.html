<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width" />
    <title>Fetch</title>
  </head>
  <body>
    <p>
      Book name:
      <input type="text" id="book-name" />
      <button onclick="createBook()">Create book</button>
    </p>

    <p id="result"></p>
    <script>
      function bookCreated(result) {
        const resultElement = document.querySelector("#result");
        resultElement.innerText = "Book created";
        const bookTitleInput = document.querySelector("#book-name");
        bookTitleInput.value = "";
      }

      function toJSON(result) {
        return result.json();
      }

      const createBook = () => {
        let bookTitleInput = document.querySelector("#book-name");
        const book = {
          description: "Sample",
          genre: ["http://195.248.240.46/genre/1/"],
          isbn: "Sample" + Math.floor(Math.random() * 1000),
          title: bookTitleInput.value,
          author: "http://195.248.240.46/author/1/",
        };

        let username = "arvin";
        let password = "WebUser1400!";

        fetch("http://195.248.240.46/book/", {
          method: "POST",
          body: JSON.stringify(book),
          headers: {
            "Content-Type": "application/json",
            Authorization: "Basic " + btoa(username + ":" + password),
          },
        })
          .then(toJSON)
          .then(bookCreated);
      };
    </script>
  </body>
</html>
